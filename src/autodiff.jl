using ChainRulesCore

@non_differentiable leg_analysis(::Any...)
@non_differentiable get_size_dict(::Any...)
@non_differentiable optimaltree(::Any...)